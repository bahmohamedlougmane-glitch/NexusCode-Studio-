<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NexusCode v2.5 - Studio Final</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .glass { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(15px); }
        body { background-color: #020617; color: white; font-family: 'Segoe UI', system-ui, sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        .hidden-app { display: none !important; }
        #editor { font-family: 'Fira Code', monospace; -webkit-overflow-scrolling: touch; }
        .input-nexus { background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 12px 16px; width: 100%; color: white; font-size: 16px; outline: none; }
        .input-nexus:focus { border-color: #3b82f6; }
    </style>
</head>
<body>

    <div id="auth-screen" class="fixed inset-0 z-[100] flex items-center justify-center bg-[#020617] p-4">
        <div class="w-full max-w-md p-8 rounded-[2.5rem] border border-white/10 glass shadow-2xl text-center">
            <img src="logo.png" alt="Nexus" id="main-logo" class="h-16 w-16 mx-auto mb-4 rounded-2xl shadow-lg shadow-blue-500/20">
            <h1 class="text-2xl font-black tracking-tighter uppercase italic">NEXUS<span class="text-blue-500">CODE</span></h1>
            <p class="text-slate-400 text-[10px] mb-8 font-bold uppercase tracking-widest">Studio Cloud Gratuit</p>
            
            <div class="space-y-3 text-left">
                <input type="text" id="reg-name" placeholder="Nom complet" class="input-nexus">
                <input type="email" id="reg-email" placeholder="E-mail" class="input-nexus">
                <input type="password" id="reg-pass" placeholder="Mot de passe" class="input-nexus">
                <button onclick="handleSignup()" class="w-full bg-blue-600 hover:bg-blue-500 py-4 rounded-xl font-bold text-sm shadow-xl transition-all active:scale-95 mt-4">
                    Cr√©er mon compte
                </button>
                <div class="text-center mt-4">
                    <button onclick="resetAccount()" class="text-[9px] text-slate-500 uppercase tracking-widest hover:text-blue-400 transition-colors">R√©inscription / Oubli</button>
                </div>
            </div>
        </div>
    </div>

    <div id="main-app" class="flex-1 flex flex-col hidden-app">
        <nav class="h-14 glass flex items-center justify-between px-4 sm:px-8 border-b border-white/5">
            <div class="flex items-center gap-2">
                <img src="logo.png" class="h-6 w-6 rounded">
                <span class="text-xs font-black tracking-tighter uppercase">Nexus <span class="text-blue-500">Studio</span></span>
            </div>
            <div class="flex items-center gap-4">
                <span id="user-display" class="hidden sm:block text-[10px] text-blue-400 font-bold bg-blue-500/10 px-3 py-1 rounded border border-blue-500/20"></span>
                <button onclick="logout()" class="text-slate-500 hover:text-red-400"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg></button>
            </div>
        </nav>

        <main class="flex-1 relative overflow-hidden flex flex-col">
            <textarea id="editor" class="flex-1 bg-transparent p-6 text-base outline-none resize-none text-slate-300 font-mono" placeholder="√âcrivez votre code ici..."></textarea>
            
            <div id="companion-bubble" class="absolute bottom-6 right-6 left-6 sm:left-auto sm:w-72 glass p-4 rounded-xl border border-white/10 shadow-2xl translate-y-40 opacity-0 transition-all duration-500 z-50">
                <div class="flex items-center gap-2 mb-1">
                    <div class="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-[10px]">ü§ñ</div>
                    <span class="font-bold text-[9px] text-blue-400 uppercase">Nexus IA</span>
                </div>
                <p id="ia-message" class="text-[11px] text-slate-200 italic"></p>
            </div>
        </main>
    </div>

    <script>
        const authScreen = document.getElementById('auth-screen');
        const mainApp = document.getElementById('main-app');
        const editor = document.getElementById('editor');
        const bubble = document.getElementById('companion-bubble');
        const iaMessage = document.getElementById('ia-message');

        // S√©curit√© Logo : Si logo.png n'existe pas, on met un cercle bleu
        document.getElementById('main-logo').onerror = function() {
            this.src = "https://ui-avatars.com/api/?name=Nexus&background=3b82f6&color=fff";
        };

        function handleSignup() {
            const name = document.getElementById('reg-name').value;
            const email = document.getElementById('reg-email').value;
            const pass = document.getElementById('reg-pass').value;
            if (name.length > 2 && email.includes('@') && pass.length > 5) {
                const data = { name, email };
                localStorage.setItem('nexus_user_data', JSON.stringify(data));
                enterApp(data);
            } else { alert("Veuillez remplir tous les champs (E-mail valide + Pass 6 car. min)"); }
        }

        function enterApp(data) {
            authScreen.classList.add('hidden-app');
            mainApp.classList.remove('hidden-app');
            document.getElementById('user-display').innerText = data.email.toUpperCase();
            showIA(`Identification r√©ussie. Bienvenue, <b>${data.name}</b>.`);
        }

        function showIA(text) {
            iaMessage.innerHTML = text;
            bubble.classList.remove('translate-y-40', 'opacity-0');
            setTimeout(() => bubble.classList.add('translate-y-40', 'opacity-0'), 5000);
        }

        function resetAccount() {
            if(confirm("Supprimer le compte pour en cr√©er un nouveau ?")) {
                localStorage.clear();
                location.reload();
            }
        }

        function logout() { location.reload(); }

        // Syst√®me de sauvegarde automatique
        window.onload = () => {
            const saved = localStorage.getItem('nexus_user_data');
            if (saved) enterApp(JSON.parse(saved));
            
            const draft = localStorage.getItem('nexus_draft');
            if (draft) editor.value = draft;
        };

        editor.addEventListener('input', () => {
            localStorage.setItem('nexus_draft', editor.value);
            // IA : D√©tecte les balises non ferm√©es
            if (editor.value.includes('<div') && !editor.value.includes('</div>')) {
                showIA("Note : N'oubliez pas de fermer votre balise &lt;div&gt;.");
            }
        });
    </script>
</body>
</html>
